# 📖 دليل الاستخدام - Amadeus Ticket Extractor

<div dir="rtl">

## 🎯 مقدمة

هذا الدليل يشرح كيفية استخدام إضافة **Amadeus Ticket Extractor** بالتفصيل.

---

## 📱 جلب التذاكر

### الخطوات:

#### 1️⃣ افتح الإضافة
- افتح صفحة Amadeus في Chrome
- اضغط على أيقونة الإضافة 🎫 في شريط الأدوات

#### 2️⃣ أدخل رقم الجوال
```
مثال: 966501234567
```
- يجب أن يبدأ بـ 966 (كود السعودية)
- بدون مسافات أو رموز
- 12 رقم إجمالاً

#### 3️⃣ اضغط "🎫 جلب التذاكر"
- ستظهر رسالة: "⏳ جاري جلب قائمة التذاكر..."
- انتظر حتى تكتمل العملية

#### 4️⃣ انتظر النتائج
الإضافة ستقوم بـ:
1. **جلب القائمة** (3 ثوان)
   - إرسال أمر: `twd/org966501234567`
   - استلام قائمة بأرقام التذاكر

2. **جلب التفاصيل** (3 ثوان لكل تذكرة)
   - إرسال أمر: `twd/1`
   - إرسال أمر: `twd/2`
   - ... وهكذا

3. **عرض النتائج**
   - جدول مفصل بـ 14 عمود
   - ملخص إحصائي

### ⏱️ الوقت المتوقع:

| عدد التذاكر | الوقت |
|-------------|-------|
| 1 | 6 ثوان |
| 2 | 9 ثوان |
| 5 | 18 ثانية |
| 10 | 33 ثانية |

---

## 📄 جلب القسائم (EMD)

### الخطوات:

#### 1️⃣ افتح الإضافة
- نفس خطوات التذاكر

#### 2️⃣ أدخل رقم الجوال
```
مثال: 966501234567
```

#### 3️⃣ اضغط "📄 جلب القسائم"
- ستظهر رسالة: "⏳ جاري جلب القسائم..."
- انتظر 6 ثوان

#### 4️⃣ النتائج
- جدول بـ 6 أعمدة
- فلترة حسب النوع (اختياري)
- ملخص إحصائي

### 🔍 فلترة القسائم:

يمكنك فلترة القسائم حسب:
- **الكل** - عرض جميع القسائم
- **BAGGAGE** - الأمتعة فقط
- **SEAT** - المقاعد فقط
- **MEAL** - الوجبات فقط
- **OTHER** - أنواع أخرى

---

## 📊 فهم النتائج

### جدول التذاكر (14 عمود):

| العمود | الوصف | مثال |
|--------|-------|------|
| # | الرقم التسلسلي | 1 |
| رقم التذكرة | 13 رقم | 0652186423097 |
| اسم المسافر | الاسم الكامل | ALANZI/HELAL MR |
| النوع | بالغ/طفل/رضيع | بالغ (ADT) |
| PNR | رمز الحجز | 9MUNFI |
| رقم الرحلة | رقم الرحلة | SV1483 |
| المسار | من → إلى | RUH → AQI |
| التاريخ | تاريخ الرحلة | 11SEP |
| الحالة | مفتوح/مغلق | مفتوح |
| السعر | السعر الأساسي | 350.00 |
| الضرائب | قيمة الضرائب | 0.00 |
| الإجمالي | السعر + الضرائب | 350.00 |
| الأمتعة | الأمتعة المسموحة | 2PC |
| طريقة الدفع | كيفية الدفع | O/GOV |

### جدول القسائم (6 أعمدة):

| العمود | الوصف | مثال |
|--------|-------|------|
| # | الرقم التسلسلي | 1 |
| رقم القسيمة | 13 رقم | 0654224198436 |
| اسم المسافر | الاسم الكامل | ALANAZI/KHALID M |
| الحالة | حالة القسيمة | صالح (V) |
| التاريخ | تاريخ الإصدار | 09SEP25 |
| الوصف | وصف الخدمة | RESIDUAL VALUE |

### حالات القسائم:

| الرمز | المعنى | الوصف |
|------|--------|-------|
| O | مفتوح | القسيمة لم تُستخدم بعد |
| C | مغلق | القسيمة مستخدمة ومغلقة |
| V | صالح | القسيمة ملغاة (Void) |
| R | مسترد | القسيمة مستردة (Refunded) |
| X | ملغي | القسيمة ملغاة (Exchanged) |
| E | منتهي | القسيمة منتهية الصلاحية |
| U | مستخدم | القسيمة مستخدمة |

---

## 📋 الملخص الإحصائي

### للتذاكر:
```
📊 ملخص النتائج:
🎫 عدد التذاكر: 5
👥 عدد المسافرين: 3
🟢 تذاكر مفتوحة: 4
🔴 تذاكر مغلقة: 1
💰 الإجمالي: 2,450.00 SAR
📅 أحدث تذكرة: 15SEP25
📅 أقدم تذكرة: 01JAN24
```

### للقسائم:
```
📊 ملخص القسائم:
📄 عدد القسائم: 9
🟢 مفتوحة: 1
🔴 مغلقة: 0
✅ صالحة: 5
💰 مستردة: 3
```

---

## 🐛 حل المشاكل

### ❌ "لم يتم العثور على صفحة Amadeus"

**السبب:**
- الإضافة لا تجد صفحة Amadeus مفتوحة

**الحل:**
1. تأكد من فتح صفحة Amadeus في Chrome
2. تحقق من أن الرابط يحتوي على "amadeus.com"
3. أعد تحميل صفحة Amadeus (F5)
4. أعد فتح الإضافة

---

### ❌ "فشل في جلب نتائج البحث"

**السبب:**
- رقم الجوال غير صحيح
- لا توجد تذاكر/قسائم لهذا الرقم
- مشكلة في الاتصال بـ Amadeus

**الحل:**
1. تأكد من صحة رقم الجوال
2. جرب رقم جوال آخر تعرف أن له تذاكر
3. تحقق من أن Amadeus يعمل بشكل صحيح
4. انتظر قليلاً وحاول مرة أخرى

---

### ❌ "بعض التذاكر لا تظهر تفاصيلها"

**السبب:**
- وقت الانتظار قصير جداً
- Amadeus بطيء في الاستجابة
- مشكلة في تحليل النص

**الحل:**
1. افتح Console (F12) لرؤية الأخطاء
2. ابحث عن رسائل باللون الأحمر
3. جرب زيادة وقت الانتظار في الكود
4. تحقق من أن Amadeus يعرض التفاصيل يدوياً

---

### ❌ "الإضافة بطيئة جداً"

**السبب:**
- هذا طبيعي! الإضافة تجلب تفاصيل كل تذكرة على حدة

**الحل:**
- يمكنك تقليل وقت الانتظار (غير مستحسن)
- افتح `popup.js` وابحث عن:
  ```javascript
  await new Promise(resolve => setTimeout(resolve, 3000));
  ```
- غيّر `3000` إلى `2000` (ثانيتين)
- **⚠️ تحذير:** قد تفقد بعض النتائج

---

### ❌ "نفس القسيمة تظهر مكررة"

**السبب:**
- هذه المشكلة تم حلها في الإصدار 4.0.2

**الحل:**
1. تأكد من أنك تستخدم الإصدار 4.0.2 أو أحدث
2. افتح `manifest.json` وتحقق من السطر:
   ```json
   "version": "4.0.2"
   ```
3. إذا كان الإصدار أقدم، حمّل النسخة الجديدة

---

## 🔍 استخدام Console للتشخيص

### كيفية فتح Console:

1. افتح الإضافة
2. اضغط F12 (أو انقر بزر الماوس الأيمن → Inspect)
3. اختر تبويب "Console"

### ما الذي تبحث عنه:

#### ✅ رسائل النجاح (باللون الأخضر):
```
✅ تم إرسال الأمر بنجاح: twd/org966501234567
✅ تم جلب النص الخام من آخر عملية بنجاح
✅ تم تحليل القسيمة 1: 0654224198436 - ALANAZI/KHALID M (حالة: V)
📊 تم استخراج 9 قسيمة من القائمة
```

#### ⚠️ رسائل التحذير (باللون الأصفر):
```
⚠️ تحذير: النص المجلوب قد لا يطابق الأمر المرسل
⚠️ تحذير: النص المجلوب قد يكون من عملية قديمة
```

#### ❌ رسائل الخطأ (باللون الأحمر):
```
❌ لم يتم العثور على مربع الإدخال في Amadeus
❌ خطأ في إرسال الأمر: ...
❌ لم يتم العثور على قسائم في النص المستلم
```

---

## 💡 نصائح وحيل

### 1️⃣ استخدم أرقام جوال صحيحة
- تأكد من أن الرقم يبدأ بـ 966
- بدون مسافات أو رموز (+، -)
- 12 رقم إجمالاً

### 2️⃣ انتظر حتى تكتمل العملية
- لا تغلق الإضافة أثناء الجلب
- لا تضغط على أزرار أخرى
- انتظر حتى ترى رسالة النجاح

### 3️⃣ استخدم Console للتشخيص
- افتح Console (F12) دائماً
- راقب الرسائل أثناء الجلب
- انسخ رسائل الخطأ إذا واجهت مشاكل

### 4️⃣ جرب أرقام مختلفة
- إذا لم يعمل رقم، جرب رقم آخر
- تأكد من أن الرقم له تذاكر/قسائم في Amadeus

### 5️⃣ أعد تحميل الصفحة عند الحاجة
- إذا توقفت الإضافة عن العمل
- اضغط F5 لإعادة تحميل صفحة Amadeus
- أعد فتح الإضافة

---

## 📞 الدعم

إذا واجهت مشاكل لم تُحل بهذا الدليل:

1. **افتح Console (F12)** وانسخ جميع الرسائل
2. **راجع CHANGELOG.md** لمعرفة المشاكل المعروفة
3. **تحقق من الإصدار** في `manifest.json`
4. **جرب إعادة تثبيت الإضافة**

---

## 🎓 أمثلة عملية

### مثال 1: جلب تذاكر لرقم واحد

```
1. رقم الجوال: 966501234567
2. اضغط "🎫 جلب التذاكر"
3. انتظر 6-18 ثانية
4. النتيجة: 5 تذاكر بتفاصيل كاملة
```

### مثال 2: جلب قسائم وفلترتها

```
1. رقم الجوال: 966501234567
2. اضغط "📄 جلب القسائم"
3. انتظر 6 ثوان
4. اختر "BAGGAGE" من قائمة الفلترة
5. النتيجة: قسائم الأمتعة فقط
```

### مثال 3: التحقق من حالة القسائم

```
1. اجلب القسائم
2. انظر إلى عمود "الحالة"
3. ستجد: صالح (V)، مسترد (R)، مفتوح (O)، إلخ
4. استخدم هذا لمعرفة حالة كل قسيمة
```

---

**آخر تحديث:** ديسمبر 2024  
**الإصدار:** 4.0.2  
**الحالة:** ✅ جاهز للاستخدام

</div>